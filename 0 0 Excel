import pandas as pd

# Load the Excel file with all sheets
file_path = 'input.xlsx'  # Replace with your file path
excel_data = pd.read_excel(file_path, sheet_name=None, header=None)  # Load all sheets

# Create a dictionary to store transformed data for each sheet
transformed_sheets = {}

# Loop through each sheet
for sheet_name, df in excel_data.items():
    transformed_data = []

    # Iterate through each column (IDs)
    for col in df.columns[1:]:  # Skip the first column (properties)
        id_value = df.iloc[1, col]  # First row contains IDs (ID1, ID2, ...)

        # Loop through each property-value pair
        for i in range(2, len(df)):
            property_name = df.iloc[i, 0]   # Property name from the first column
            property_value = df.iloc[i, col]  # Corresponding value
            transformed_data.append([id_value, property_name, property_value])

    # Convert the transformed data to a DataFrame
    transformed_df = pd.DataFrame(transformed_data, columns=['ID', 'Property', 'Value'])
    transformed_sheets[sheet_name] = transformed_df  # Store the transformed sheet

# Save all transformed sheets into a new Excel file
with pd.ExcelWriter('transformed_multiple_sheets.xlsx') as writer:
    for sheet_name, transformed_df in transformed_sheets.items():
        transformed_df.to_excel(writer, sheet_name=sheet_name, index=False)

print("Transformation complete! Check 'transformed_multiple_sheets.xlsx'.")

# Save to Excel (optional)
result_df.to_excel('transformed_output.xlsx', index=False)

print(result_df)
