import pandas as pd

# Load the Excel file
file_path = 'input.xlsx'  # Replace with your actual file path
df = pd.read_excel(file_path, header=None)

# Initialize an empty list to collect the transformed data
transformed_data = []

# Iterate over the columns starting from the second column
for col in df.columns[1:]:
    id_value = df.iloc[0, col]  # First row contains the IDs (ID1, ID2, ID3)
    
    # Loop through the remaining rows to get property-value pairs
    for i in range(1, len(df)):
        property_name = df.iloc[i, 0]  # First column contains property names (Name, Age, City)
        property_value = df.iloc[i, col]  # Corresponding value
        transformed_data.append([id_value, property_name, property_value])

# Convert the transformed data into a DataFrame
result_df = pd.DataFrame(transformed_data, columns=['ID', 'Property', 'Value'])

# Save the result to a new Excel file
result_df.to_excel('transformed_output.xlsx', index=False)

print("Transformation complete! Check 'transformed_output.xlsx'.")
