import pandas as pd

# Load the Excel file with all sheets
file_path = 'input.xlsx'  # Replace with your file path
excel_data = pd.read_excel(file_path, sheet_name=None, header=None)  # Load all sheets

# Dictionary to store transformed data for each sheet
transformed_sheets = {}

# Process each sheet
for sheet_name, df in excel_data.items():
    transformed_data = []

    # Iterate through each column starting from the third column to skip the extra column
    for col in df.columns[2:]:
        id_value = df.iloc[0, col]      # ID1, ID2, ID3
        type_value = df.iloc[1, col]    # Type (A, B, C)

        # Loop through the property-value pairs
        for i in range(2, len(df)):
            property_name = df.iloc[i, 1]  # Property names (Name, Age, City)
            property_value = df.iloc[i, col]  # Corresponding values
            transformed_data.append([id_value, type_value, property_name, property_value])

    # Convert the transformed data into a DataFrame
    transformed_df = pd.DataFrame(transformed_data, columns=['ID', 'Type', 'Property', 'Value'])
    
    # Store the transformed sheet
    transformed_sheets[sheet_name] = transformed_df

# Save all transformed sheets into a new Excel file
with pd.ExcelWriter('transformed_with_extra_column.xlsx') as writer:
    for sheet_name, transformed_df in transformed_sheets.items():
        transformed_df.to_excel(writer, sheet_name=sheet_name, index=False)

print("Transformation complete! Check 'transformed_with_extra_column.xlsx'.")
