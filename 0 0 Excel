import pandas as pd

# Load the Excel file with all sheets
file_path = 'input.xlsx'  # Replace with your actual file path
excel_data = pd.read_excel(file_path, sheet_name=None, header=None)  # Load all sheets

# Create a dictionary to store transformed data for each sheet
transformed_sheets = {}

# Process each sheet
for sheet_name, df in excel_data.items():
    transformed_data = []

    # Iterate through each column starting from the second column
    for col in df.columns[1:]:
        id_value = df.iloc[0, col]  # First row contains IDs (ID1, ID2, ID3, etc.)

        # Loop through the property-value pairs
        for i in range(1, len(df)):
            property_name = df.iloc[i, 0]  # First column contains property names (Name, Age, City)
            property_value = df.iloc[i, col]  # Corresponding value for each ID
            transformed_data.append([id_value, property_name, property_value])

    # Convert the transformed data into a DataFrame
    transformed_df = pd.DataFrame(transformed_data, columns=['ID', 'Property', 'Value'])
    
    # Store each transformed sheet in a dictionary
    transformed_sheets[sheet_name] = transformed_df

# Save all transformed sheets into a new Excel file
with pd.ExcelWriter('transformed_multiple_sheets.xlsx') as writer:
    for sheet_name, transformed_df in transformed_sheets.items():
        transformed_df.to_excel(writer, sheet_name=sheet_name, index=False)

print("Transformation complete! Check 'transformed_multiple_sheets.xlsx'.")
