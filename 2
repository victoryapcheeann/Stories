import React from 'react';
import { AgGridReact } from 'ag-grid-react';
import { GridApi } from 'ag-grid-community';
import 'ag-grid-community/styles/ag-grid.css';
import 'ag-grid-community/styles/ag-theme-alpine.css';

const GridComponent: React.FC = () => {
  const [gridApi, setGridApi] = React.useState<GridApi | null>(null);

  // Column definitions, including 'id'
  const columnDefs = [
    { headerName: 'ID', field: 'id' },
    { headerName: 'Name', field: 'name' },
    { headerName: 'Age', field: 'age' },
  ];

  // Sample row data
  const rowData = [
    { id: 1, name: 'John Doe', age: 30 },
    { id: 2, name: 'Jane Smith', age: 25 },
    { id: 3, name: 'Jack Johnson', age: 40 },
  ];

  // Function to handle grid ready event
  const onGridReady = (params: any) => {
    setGridApi(params.api);
  };

  // Function to filter selected rows by ID using quick filter
  const filterSelectedRows = () => {
    if (!gridApi) return;

    // Get the selected rows
    const selectedRows = gridApi.getSelectedRows();

    // Extract the IDs from the selected rows and join them into a string
    const selectedIds = selectedRows.map((row) => row.id.toString()).join(' ');

    // Apply the quick filter to show only rows with the selected IDs
    gridApi.setQuickFilter(selectedIds);
  };

  // Function to reset the filter and show all rows again
  const resetFilter = () => {
    if (!gridApi) return;

    // Clear the quick filter by passing an empty string
    gridApi.setQuickFilter('');
  };

  return (
    <div>
      <div className="button-group">
        <button onClick={filterSelectedRows}>Filter Selected Rows</button>
        <button onClick={resetFilter}>Show All Rows</button>
      </div>

      <div className="ag-theme-alpine" style={{ height: 400, width: 600 }}>
        <AgGridReact
          columnDefs={columnDefs}
          rowData={rowData}
          rowSelection="multiple"
          onGridReady={onGridReady}
        />
      </div>
    </div>
  );
};

export default GridComponent;
