import { Autocomplete } from '@mantine/core';
import { forwardRef, useEffect, useImperativeHandle, useState } from 'react';

const MantineAutocompleteCellEditor = forwardRef((props, ref) => {
  const [value, setValue] = useState(props.value || '');
  const options = props.values || [];

  useEffect(() => {
    const input = document.querySelector('input');
    if (input) input.focus();
  }, []);

  useImperativeHandle(ref, () => ({
    getValue: () => value,
    afterGuiAttached: () => {
      const input = document.querySelector('input');
      if (input) input.focus();
    },
  }));

  return (
    <Autocomplete
      value={value}
      data={options}
      onChange={(newValue) => setValue(newValue)}
      placeholder="Type or select"
      nothingFound="No options"
      styles={{ input: { width: '100%' } }}
    />
  );
});

export default MantineAutocompleteCellEditor;
